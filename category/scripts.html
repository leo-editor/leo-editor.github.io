<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Leo Blog - scripts</title>
        <link rel="stylesheet" href="http://leo-editor.github.io/theme/css/main.css" />
        <link href="http://leo-editor.github.io/feeds\all.atom.xml" type="application/atom+xml" rel="alternate" title="Leo Blog Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://leo-editor.github.io/">Leo Blog </a></h1>
                <nav><ul>
                    <li><a href="http://leo-editor.github.io/category/plugins.html">plugins</a></li>
                    <li class="active"><a href="http://leo-editor.github.io/category/scripts.html">scripts</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://leo-editor.github.io/register_leo.html">Registering Leo with Windows</a></h1>
<footer class="post-info">
        <abbr class="published" title="2013-11-28T00:00:00">
                Thu 28 November 2013
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="http://leo-editor.github.io/author/matt-wilkie.html">Matt Wilkie</a>
        </address>
<p>In <a href="http://leo-editor.github.io/category/scripts.html">scripts</a>. </p>
<p>tags: <a href="http://leo-editor.github.io/tag/windows.html">Windows</a><a href="http://leo-editor.github.io/tag/install.html">install</a><a href="http://leo-editor.github.io/tag/scripts.html">scripts</a></p>
</footer><!-- /.post-info --><p><em>a post in progress</em></p>
<p>Installing Leo using the standard setup program from Sourceforge does nice things like create Start Menu &amp; Desktop shortcuts and enable open Leo files with a simple double-click. For those that like to run from source code or a portable drive there are <a href="http://leoeditor.com/installing.html#installing-from-sources-windows">manual instructions</a> for doing the same, but it's fiddly and rapidly gets old. Why repeat when automation is possible?</p>
<p>Introducing <strong><a href="http://bazaar.launchpad.net/~leo-editor-team/leo-editor/trunk3/view/head:/leo/scripts/register-leo.leox">register-leo.leox</a></strong> (and <a href="http://bazaar.launchpad.net/~leo-editor-team/leo-editor/trunk3/view/head:/leo/scripts/unregister-leo.leox">unregister-leo</a>): which creates the necessary Windows registry keys for integration with Explorer and friends. After running this script .leo and .leox files are shown with the Leo icon, and double-clicking on them will open them in Leo.</p>
<p>To use: open a command shell with administrative rights, and run:</p>
<div class="highlight"><pre>    d:\path\to\python.exe d:\path\to\leo\launchLeo.py e:\path\to\register-leo.leox
</pre></div>


<p>All in one step: you can try the <a href="http://bazaar.launchpad.net/~leo-editor-team/leo-editor/trunk3/view/head:/leo/scripts/elevate.py"><code>elevate.py</code></a> script which will ask for Admin privileges from a regular command shell:</p>
<div class="highlight"><pre>    d:\path\to\python.exe d:\path\to\leo\leo\scripts\elevate.py e:\path\to\register-leo.leox
</pre></div>


<p>Eventually I'd like to see this activated from a Settings/Options/Preferences menu. Then we can distribute daily and portable builds of Leo and still have easy (dis)integration with the host (on Windows) and not rely so heavily on stable builds and installers, which are few and long between 'cause of the pain in building them.</p>
<p>Developed and tested with Python 2.7, Leo 4.10 and Win7 x64. Py3 needs work.</p>
<p>Feedback/testing/patches welcome (see mailing list).</p>
<p>-Matt Wilkie</p>
<hr />
<h2>Notes</h2>
<h4>What's this <code>.leox</code>?</h4>
<p>I created this convention so I could easily distinguish regular Leo files, which can be about anything, and Leo files which are runnable Leo scripts. The intention is to allow for things like:</p>
<div class="highlight"><pre>    leo --script d:\path\to\scripts\register-leo.leox
</pre></div>


<p>At present double-clicking a .leox opens in edit mode. It occurs to me as I write this it could be changed so it runs automatically by adding, <code>--script</code> (quotes might need fiddling with):</p>
<div class="highlight"><pre><span class="n">ftype</span> <span class="n">LeoFile</span><span class="o">=</span><span class="s">&quot;C:\Python27\python.exe&quot;</span> <span class="s">&quot;B:</span><span class="se">\a</span><span class="s">pps\leo\launchLeo.py&quot;</span> <span class="s">&quot;--script &quot;&quot;%1&quot;&quot; %*</span>
</pre></div>


<h4>Any .leo is a launcher</h4>
<p>Association has the added benefit of removing the need for most to create a batch file and then figure out where in PATH to store it in order to use Leo. As a matter of fact, any .leo file becomes the equivalent of launchLeo.py, just try this:</p>
<div class="highlight"><pre><span class="c">%homedrive%\homepath%\workbook.leo x:\path\to\some\other\leofile.leo</span>
</pre></div>


<p>or to build on the previous note:</p>
<div class="highlight"><pre><span class="c">%homedrive%\homepath%\workbook.leo --script ..\scripts\unregister-leo.leox</span>
</pre></div>


<h3>Resources used</h3>
<p>http://superuser.com/questions/88491/force-cmd-exe-to-run-as-admin/<br />
http://stackoverflow.com/questions/2331690/how-to-set-a-icon-file-while-creating-file<br />
http://stackoverflow.com/questions/771689/how-can-i-set-an-icon-for-my-own-file-extension</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://leoeditor.com/">Leo project website</a></li>
                            <li><a href="https://groups.google.com/forum/?fromgroups#!forum/leo-editor">Leo community mailing list</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://leo-editor.github.io/feeds\all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>